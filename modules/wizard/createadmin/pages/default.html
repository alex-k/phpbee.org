{extends file="admin_page.html"}

{block name="main"}


	<h4>{%$rs.title%}</h4>


	{%foreach from=$filters item=f%}
		{handler gspgid="/filter/" class="select_by_links" link="{%$rs.name%}.{%$f.name%}:urlkey" name="{%$f.name%}" urltype=get }
		{%$s_filters=$s_filters|cat:$f.name|cat:","%}
	{%/foreach%}
	{controller _class="{%$rs.name%}" _assign="{%$rs.name%}" _filters="{%$s_filters|trim:","%}"}

	<table class="tb">
	<thead>
	<tr class="filters"><td colspan="100">
	<table><tr>
	{%foreach from=$filters item=f%}
		<td>{%$f.verbose_name%}: {handler gspgid="/filter/show" name="{%$f.name%}"  recordset=${%$rs.name%} tpl="links_line.html"  }</td>
	{%/foreach%}
	</tr></table>
	</td> </tr>
	<tr><th>#</th>
	{%foreach from=$fields item=f%}
	<th>{%$f.verbose_name%}</th>
	{%/foreach%}
	{%foreach from=$links item=f%}
	<th>{%$f.verbose_name%}</th>
	{%/foreach%}
	<th></th>
	<th></th>
	</tr>
	</thead>
	{foreach from=${%$rs.name%} item="e"}
	<tr class="{cycle values='odd,even'}">
			<td>{$e.id}</td>
			{%foreach from=$fields item=f%}
			<td>{$e.{%$f.name%}}</td>
			{%/foreach%}
			{%foreach from=$links item=f%}
			<td>{$e.{%$f.name%}}</td>
			{%/foreach%}
			<td class="cnt"><a href="/admin/{%$module.name%}/{%$rs.name%}/modify/{$e.id}#form"><img src="/i/admin/ico_edit.png" alt="Редактировать" title="Редактировать"></a></td>
			<td class="cnt"><a href="/admin/{%$module.name%}/{%$rs.name%}/delete/{$e.id}" onclick="return confirm('Вы точно хотите удалить запись ?');"><img src="/i/admin/ico_delete.png" alt="Удалить" title="Удалить"></a></td>
	</tr>
	{/foreach}
	</table>

	<h5>Редактировать/<a href="/admin/{%$module.name%}/{%$rs.name%}/modify/0#form">создать</a>:</h5>
	{if $_gsdata.gspgid_va.0=='modify'}
	<hr><br>
	<a name="form"></a>
	{handler gspgid="/admin/form/{%$rs.name%}/edit/`$_gsdata.gspgid_va.1`"}
	{/if}

{/block}
